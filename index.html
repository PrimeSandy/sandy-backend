<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- SEO Optimized -->
    <title>E-TRAX | Smart Expense Tracker</title>
    <meta charset="UTF-8" />
    <meta name="description" content="E-TRAX is a smart expense tracker to manage daily income and expenses with analytics, Firebase login, and secure cloud storage." />
    <meta name="keywords" content="expense tracker, budget app, money manager, finance tracker, E-TRAX, alphaprime" />
    <meta name="author" content="AlphaPrime" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="index, follow" />

    <!-- Open Graph -->
    <meta property="og:title" content="E-TRAX | Smart Expense Tracker" />
    <meta property="og:description" content="Track your expenses smartly with E-TRAX. Secure, fast and simple expense tracking app." />
    <meta property="og:url" content="https://alphaprime.co.in" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://alphaprime.co.in/og-image.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="E-TRAX | Smart Expense Tracker">
    <meta name="twitter:description" content="Track expenses smartly with analytics & secure Firebase login.">
    <meta name="twitter:image" content="https://alphaprime.co.in/og-image.png">

    <!-- Favicon -->
    <link rel="canonical" href="https://alphaprime.co.in" />
    <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="E Trax" />
    <meta name="theme-color" content="#00bcd4">
    <link rel="manifest" href="site.webmanifest" />

    <!-- External Libraries -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "E-TRAX",
      "operatingSystem": "Web",
      "applicationCategory": "FinanceApplication",
      "description": "E-TRAX is a smart expense tracker to manage daily income and expenses securely.",
      "url": "https://alphaprime.co.in",
      "publisher": {
        "@type": "Organization",
        "name": "AlphaPrime",
        "url": "https://alphaprime.co.in"
      }
    }
    </script>

    <style>
    :root {
      /* Dark Theme (Default) - HIGH CONTRAST */
      --primary: #00bcd4;
      --primary-dark: #0097a7;
      --secondary: #ffcc00;
      --background: #0b0b0b;
      --card-bg: #1a1a1a;
      --text: #ffffff;
      --text-light: #f1f5f9;
      --text-muted: #cbd5e1;
      --border: rgba(255,255,255,0.2);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,0.6);
      --gradient: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
    }

    [data-theme="light"] {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --secondary: #dc2626;
      --background: #ffffff;
      --card-bg: #f8fafc;
      --text: #000000;
      --text-light: #1e293b;
      --text-muted: #475569;
      --border: rgba(0,0,0,0.15);
      --success: #059669;
      --warning: #d97706;
      --danger: #dc2626;
      --shadow: 0 10px 30px rgba(0,0,0,0.1);
      --gradient: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    }

    [data-theme="professional"] {
      --primary: #3b82f6;
      --primary-dark: #2563eb;
      --secondary: #f59e0b;
      --background: #0f172a;
      --card-bg: #1e293b;
      --text: #ffffff;
      --text-light: #e2e8f0;
      --text-muted: #94a3b8;
      --border: rgba(255,255,255,0.2);
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,0.5);
      --gradient: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    }

    * {
      box-sizing: border-box;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
    }

    body {
      background-color: var(--background);
      color: var(--text);
      min-height: 100vh;
      margin: 0;
      font-family: "Poppins", sans-serif;
      line-height: 1.6;
      font-weight: 500;
      overflow-x: hidden;
    }

    /* ---------- ENHANCED LOADING STATES ---------- */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(5px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 99999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .loading-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    .loading-steps {
      color: var(--text);
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      margin-top: 15px;
      height: 24px;
    }

    .loading-step {
      opacity: 0;
      transform: translateY(10px);
      animation: stepFade 0.5s ease forwards;
    }

    @keyframes stepFade {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* ---------- ENHANCED LOGIN CARD ---------- */
    .login-wrapper {
      display: flex;
      align-items: center; 
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      background: linear-gradient(135deg, var(--background) 0%, var(--card-bg) 100%);
      position: relative;
      overflow: hidden;
    }

    .login-wrapper::before {
      content: '';
      position: absolute;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(0,188,212,0.1) 0%, transparent 70%);
      animation: pulse 15s infinite linear;
    }

    @keyframes pulse {
      0% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.1); }
      100% { transform: translate(-50%, -50%) scale(1); }
    }

    .login-card {
      width: 100%;
      max-width: 460px;
      background: var(--card-bg);
      border-radius: 20px;
      box-shadow: var(--shadow);
      padding: 45px 35px;
      text-align: center;
      border: 1px solid var(--border);
      position: relative;
      z-index: 1;
    }

    .login-card h1 { 
      color: var(--primary); 
      margin-bottom: 10px; 
      font-size: 2.4rem; 
      font-weight: 700;
      letter-spacing: 1px;
      background: var(--gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .login-card p { 
      color: var(--text-light); 
      margin-bottom: 30px; 
      font-size: 1.1rem;
      font-weight: 500;
      line-height: 1.5;
    }

    .google-btn {
      display:flex; 
      align-items:center; 
      gap:12px; 
      justify-content:center;
      width:100%; 
      background: var(--text);
      color: var(--background);
      border-radius:12px; 
      padding:16px 20px;
      font-weight:600; 
      cursor:pointer; 
      border:none;
      box-shadow: 0 4px 15px rgba(2,6,23,0.4);
      transition: all 0.3s ease;
      font-size: 1rem;
      position: relative;
      overflow: hidden;
    }

    .google-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(2,6,23,0.5);
    }

    .google-btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
    }

    .google-btn .btn-text {
      transition: opacity 0.3s ease;
    }

    .google-btn.loading .btn-text {
      opacity: 0;
    }

    .google-btn .loading-dots {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0;
      transition: opacity 0.3s ease;
      font-weight: 600;
    }

    .google-btn.loading .loading-dots {
      opacity: 1;
    }

    .loading-dots:after {
      content: 'Connecting to Server';
      animation: loadingSteps 4s infinite;
    }

    @keyframes loadingSteps {
      0% { content: 'Connecting to Server'; }
      20% { content: 'Logging in'; }
      40% { content: 'Optimizing Function'; }
      60% { content: 'Checking Authorized User'; }
      80% { content: 'Finalizing Login'; }
      100% { content: 'Connecting to Server'; }
    }

    .google-btn img { 
      width:22px; 
      height:22px; 
      transition: transform 0.3s ease;
    }

    .google-btn:hover img {
      transform: scale(1.1);
    }

    .small-note { 
      color: var(--text-muted); 
      font-size:0.9rem; 
      margin-top:20px; 
      font-weight: 500;
      line-height: 1.4;
    }

    /* ---------- ENHANCED HEADER ---------- */
    header { 
      display: none;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border);
      padding: 15px 25px;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 25px rgba(0,0,0,0.2);
    }

    header.visible {
      display: block;
      animation: slideDown 0.5s ease;
    }

    @keyframes slideDown {
      from { transform: translateY(-100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }

    .brand-section {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .brand-section h1 {
      font-size: 1.6rem; 
      color: var(--primary); 
      font-weight: 800; 
      margin: 0;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .typing { 
      font-size: 0.95rem; 
      color: var(--secondary); 
      font-weight: 600;
      min-height: 1.2rem;
      position: relative;
      padding-left: 20px;
    }

    .typing::before {
      content: 'üìä';
      position: absolute;
      left: 0;
      top: 0;
    }

    .header-controls {
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    #userNameDisplay {
      color: var(--secondary);
      font-weight: 700;
      font-size: 1rem;
      background: rgba(255,204,0,0.1);
      padding: 6px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255,204,0,0.3);
    }

    .theme-toggle {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px 15px;
      color: var(--text);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      font-weight: 600;
      min-width: 100px;
      justify-content: center;
    }

    .theme-toggle:hover {
      background: var(--primary);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .nav-links a { 
      color: var(--text); 
      text-decoration:none; 
      font-weight:600; 
      transition:all 0.3s ease; 
      position: relative;
      padding: 8px 15px;
      border-radius: 8px;
      font-size: 0.95rem;
    }

    .nav-links a:hover { 
      color: var(--primary);
      background: rgba(0,188,212,0.1);
      transform: translateY(-2px);
    }

    .nav-links a i {
      margin-right: 6px;
    }

    #googleLogoutBtn {
      background: transparent; 
      border: 2px solid var(--danger); 
      color: var(--danger);
      font-weight:600; 
      border-radius:10px; 
      padding:10px 18px; 
      transition:all 0.3s ease;
      cursor: pointer;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    #googleLogoutBtn:hover { 
      background:var(--danger); 
      color:white; 
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(239,68,68,0.3);
    }

    /* ---------- ENHANCED MAIN CONTENT ---------- */
    .container {
      padding: 25px 15px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* ---------- ENHANCED CARDS ---------- */
    .card {
      background: var(--card-bg);
      border-radius: 16px;
      border: 1px solid var(--border);
      box-shadow: 0 8px 30px rgba(0,0,0,0.4);
      transition: all 0.3s ease;
      margin-bottom: 25px;
      color: var(--text);
      overflow: hidden;
    }

    .card:hover {
      box-shadow: 0 12px 35px rgba(0,0,0,0.5);
      transform: translateY(-3px);
    }

    .card-header {
      background: var(--gradient);
      border-bottom: none;
      padding: 20px 25px;
      border-radius: 16px 16px 0 0 !important;
      color: white;
      font-weight: 700;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .card-body {
      padding: 25px;
      color: var(--text);
    }

    /* ---------- ENHANCED EXPENSE CARDS FOR MOBILE ---------- */
    .expense-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: 16px;
      margin-bottom: 15px;
      overflow: hidden;
      position: relative;
    }

    .expense-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--gradient);
    }

    .expense-card .card-body {
      padding: 20px;
    }

    .expense-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 8px;
    }

    .expense-meta {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.9rem;
    }

    .expense-amount {
      color: var(--success);
      font-weight: 700;
      font-size: 1.2rem;
    }

    .expense-type {
      background: rgba(0,188,212,0.1);
      color: var(--primary);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .expense-description {
      color: var(--text-light);
      font-size: 0.95rem;
      margin: 10px 0;
      line-height: 1.5;
    }

    .expense-date {
      color: var(--text-muted);
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .expense-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .expense-actions .btn {
      flex: 1;
      padding: 8px 12px;
      font-size: 0.9rem;
      border-radius: 10px;
    }

    /* ---------- ENHANCED BUDGET SECTION ---------- */
    #budgetCard { 
      display:none; 
    }

    .budget-progress-container {
      margin: 20px 0;
    }

    .budget-stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-weight: 600;
    }

    #budgetBar { 
      height: 25px; 
      border-radius:12px; 
      overflow:hidden; 
      background: var(--border);
      margin-top: 10px;
      position: relative;
    }

    #budgetBar .progress { 
      height:100%; 
      transition: width 0.5s ease;
    }

    .budget-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .budget-alert {
      padding: 15px;
      border-radius: 12px;
      margin-top: 15px;
      font-weight: 600;
      text-align: center;
      animation: pulseAlert 2s infinite;
    }

    @keyframes pulseAlert {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }

    /* ---------- ENHANCED FORM ---------- */
    .form-control, .form-select {
      background: var(--card-bg);
      border: 2px solid var(--border);
      color: var(--text);
      border-radius: 12px;
      padding: 12px 18px;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
      background: var(--card-bg);
      border-color: var(--primary);
      color: var(--text);
      box-shadow: 0 0 0 0.3rem rgba(0,188,212,0.25);
      transform: translateY(-1px);
    }

    .form-label {
      color: var(--text-light);
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 1rem;
    }

    /* ---------- ENHANCED BUTTONS ---------- */
    .btn {
      border-radius: 12px;
      font-weight: 600;
      padding: 12px 25px;
      transition: all 0.3s ease;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    .btn-primary {
      background: var(--gradient);
      color: white;
      border: none;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
      color: white;
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
      color: white;
    }

    .btn-warning {
      background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
      color: white;
      font-weight: 600;
    }

    .btn-info {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
    }

    .btn-outline-danger {
      border: 2px solid var(--danger);
      color: var(--danger);
      background: transparent;
    }

    .btn-outline-danger:hover {
      background: var(--danger);
      color: white;
    }

    .btn-sm {
      padding: 8px 15px;
      font-size: 0.9rem;
    }

    /* ---------- ENHANCED MODALS ---------- */
    .modal-overlay {
      display:none; 
      position:fixed; 
      top:0; 
      left:0; 
      width:100%; 
      height:100%;
      background: rgba(0,0,0,0.9); 
      color: var(--text); 
      z-index:9999; 
      overflow:auto;
      padding:30px 15px; 
      box-sizing:border-box;
      backdrop-filter: blur(10px);
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal-content {
      max-width:800px; 
      margin:auto; 
      background: var(--card-bg); 
      padding:35px; 
      border-radius:24px; 
      box-shadow: 0 15px 40px rgba(0,0,0,0.6);
      animation: modalSlideUp 0.4s ease;
      border: 1px solid var(--border);
      color: var(--text);
    }

    @keyframes modalSlideUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .modal-content h2 { 
      color: var(--primary); 
      text-align:center; 
      margin-bottom:25px; 
      font-weight: 800;
      font-size: 2rem;
    }

    /* ---------- ENHANCED HISTORY TABLE ---------- */
    .history-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 20px;
      color: var(--text);
      border-radius: 12px;
      overflow: hidden;
    }

    .history-table th,
    .history-table td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid var(--border);
      color: var(--text);
      font-weight: 500;
    }

    .history-table th {
      background: var(--gradient);
      color: white;
      font-weight: 700;
      font-size: 1rem;
    }

    .history-table tr:hover {
      background: rgba(0,188,212,0.08);
    }

    .changes-list {
      font-size: 0.9rem;
    }

    .changes-list div {
      margin: 4px 0;
      padding: 6px 10px;
      border-radius: 8px;
      background: rgba(0,188,212,0.1);
      color: var(--text);
      font-weight: 500;
      border-left: 3px solid var(--primary);
    }

    /* ---------- ENHANCED MESSAGE BOX ---------- */
    #msgBox {
      position: fixed; 
      top: 30px; 
      right: 30px;
      background: var(--gradient);
      color: white; 
      padding: 16px 28px;
      border-radius: 14px; 
      display: none; 
      z-index: 9999;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      animation: slideInRight 0.4s ease;
      font-weight: 700;
      font-size: 1rem;
      border: none;
      max-width: 400px;
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* ---------- ENHANCED FOOTER ---------- */
    footer {
      background: var(--card-bg);
      color: var(--text-muted);
      text-align:center; 
      padding:30px 20px; 
      border-top:2px solid var(--border);
      margin-top:50px; 
      font-size:0.95rem;
      font-weight: 500;
    }

    .footer-content {
      max-width: 600px;
      margin: 0 auto;
    }

    .blinking-name { 
      color: var(--primary); 
      animation: blink 2s infinite;
      font-weight: 800;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    footer a {
      color: var(--primary);
      text-decoration: none;
      transition: all 0.3s ease;
      font-weight: 600;
      padding: 5px;
      border-radius: 6px;
    }

    footer a:hover {
      color: var(--primary-dark);
      text-decoration: none;
      background: rgba(0,188,212,0.1);
    }

    /* ---------- ENHANCED RESPONSIVE DESIGN ---------- */
    @media (max-width: 768px) {
      .login-card {
        padding: 35px 25px;
        border-radius: 18px;
        margin: 15px;
      }
      
      .login-card h1 {
        font-size: 2rem;
      }
      
      .login-card p {
        font-size: 1rem;
      }
      
      .header-content {
        flex-direction: column;
        text-align: center;
        gap: 12px;
      }
      
      .brand-section {
        flex-direction: column;
        gap: 8px;
      }
      
      .header-controls {
        flex-direction: column;
        gap: 12px;
        width: 100%;
      }
      
      .nav-links {
        justify-content: center;
        flex-wrap: wrap;
        width: 100%;
      }
      
      .nav-links a {
        padding: 8px 12px;
        font-size: 0.9rem;
      }
      
      .card-header {
        padding: 18px 20px;
        font-size: 1rem;
      }
      
      .card-body {
        padding: 20px;
      }
      
      .expense-actions {
        flex-direction: column;
      }
      
      .expense-actions .btn {
        width: 100%;
      }
      
      #msgBox {
        top: 20px;
        right: 15px;
        left: 15px;
        max-width: none;
        text-align: center;
      }
      
      .modal-content {
        padding: 25px 20px;
        margin: 20px 15px;
      }
      
      .chart-container {
        height: 250px;
      }
      
      .google-btn {
        padding: 15px 18px;
      }
      
      .theme-toggle span {
        display: none;
      }
    }

    @media (max-width: 576px) {
      .container {
        padding: 20px 10px;
      }
      
      .login-wrapper {
        padding: 15px;
      }
      
      .login-card {
        padding: 30px 20px;
      }
      
      .btn {
        padding: 10px 20px;
        font-size: 0.95rem;
      }
      
      .form-control, .form-select {
        padding: 10px 15px;
        font-size: 1rem;
      }
      
      .expense-title {
        font-size: 1rem;
      }
      
      .expense-amount {
        font-size: 1.1rem;
      }
      
      .header-controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      #userNameDisplay {
        text-align: center;
        margin-bottom: 5px;
      }
      
      .nav-links {
        justify-content: space-between;
      }
      
      .nav-links a {
        flex: 1;
        text-align: center;
        padding: 10px 5px;
        font-size: 0.85rem;
      }
    }

    @media (min-width: 769px) and (max-width: 1200px) {
      .container {
        padding: 30px 20px;
      }
      
      .card {
        margin-bottom: 20px;
      }
    }

    /* ---------- ENHANCED CHART CONTAINERS ---------- */
    .chart-container {
      position: relative;
      height: 320px;
      margin-bottom: 25px;
      background: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid var(--border);
    }

    /* ---------- ENHANCED BADGES ---------- */
    .badge {
      padding: 8px 15px;
      border-radius: 25px;
      font-size: 0.85rem;
      font-weight: 700;
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 5px;
    }

    .badge-success {
      background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      color: white;
    }

    .badge-warning {
      background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
      color: white;
    }

    .badge-danger {
      background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
      color: white;
    }

    .badge-info {
      background: var(--gradient);
      color: white;
    }

    /* ---------- ENHANCED TABLE RESPONSIVENESS ---------- */
    .table-responsive {
      border-radius: 16px;
      overflow: hidden;
      background: var(--card-bg);
      border: 1px solid var(--border);
      margin-top: 20px;
    }

    .table {
      color: var(--text) !important;
      margin-bottom: 0;
    }

    .table thead th {
      background: var(--gradient);
      color: white;
      font-weight: 700;
      padding: 18px 15px;
      border: none;
    }

    .table tbody td {
      padding: 15px;
      vertical-align: middle;
      border-color: var(--border);
      font-weight: 500;
    }

    .table tbody tr:hover {
      background: rgba(0,188,212,0.08);
    }

    /* Force horizontal scroll on mobile */
    @media (max-width: 768px) {
      .table-responsive {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      .table {
        min-width: 650px;
      }
      
      .table thead th,
      .table tbody td {
        padding: 12px 8px;
        font-size: 0.9rem;
      }
      
      .btn-group .btn-sm {
        padding: 6px 10px;
        font-size: 0.8rem;
      }
    }

    /* ---------- ENHANCED TEXT STYLES ---------- */
    .text-muted {
      color: var(--text-muted) !important;
      font-weight: 500;
    }

    .high-contrast-text {
      color: var(--text) !important;
      font-weight: 700 !important;
    }

    /* ---------- ENHANCED GRID SYSTEM ---------- */
    .row {
      margin-bottom: 20px;
    }

    .row.g-3 {
      --bs-gutter-x: 1rem;
      --bs-gutter-y: 1rem;
    }

    /* ---------- UTILITY CLASSES ---------- */
    .fade-in {
      animation: fadeIn 0.5s ease;
    }

    .slide-up {
      animation: slideUp 0.5s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .pulse {
      animation: pulse 2s infinite;
    }

    /* ---------- SCROLLBAR STYLING ---------- */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: var(--card-bg);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--primary);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }
    </style>
  </head>

  <body>
    <!-- LOADING OVERLAY -->
    <div id="loadingOverlay" class="loading-overlay">
      <div class="loading-spinner"></div>
      <div class="loading-steps" id="loadingSteps"></div>
    </div>

    <!-- LOGIN VIEW -->
    <div id="loginView" class="login-wrapper">
      <div class="login-card fade-in">
        <h1>E-TRAX</h1>
        <p>Track expenses ‚Äî smarter. Sign in with Google to continue.</p>

        <button id="googleLoginBtn" class="google-btn" aria-label="Login with Google">
          <img src="https://developers.google.com/identity/images/g-logo.png" alt="Google">
          <span class="btn-text">Sign in with Google</span>
          <span class="loading-dots"></span>
        </button>

        <div class="small-note">We only use Google to authenticate you ‚Äî no payment info required.</div>
        <div style="margin-top:20px;">
          <small style="color:var(--text-muted)">Developed by <strong style="color:var(--primary)">ALPHA DEVELOPERS </strong></small>
        </div>
      </div>
    </div>

    <!-- HEADER -->
    <header id="mainHeader">
      <div class="header-content">
        <div class="brand-section">
          <h1 class="project-name">E-TRAX</h1>
          <div class="typing" id="typingHeader"></div>
        </div>
        
        <div class="header-controls">
          <div id="userNameDisplay"></div>
          
          <button class="theme-toggle" id="themeToggle">
            <i class="fas fa-palette"></i>
            <span>Theme</span>
          </button>
          
          <nav class="nav-links">
            <a href="https://whatsapp.com/channel/0029Va5gnd0CcW4xKICHcb0k" target="_blank" rel="noopener">
              <i class="fas fa-phone"></i> Contact
            </a>
            <a href="#" id="aboutLink">
              <i class="fas fa-info-circle"></i> About
            </a>
            <a href="#" id="historyLink">
              <i class="fas fa-history"></i> History
            </a>
            <button id="googleLogoutBtn">
              <i class="fas fa-sign-out-alt"></i> Logout
            </button>
          </nav>
        </div>
      </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="container my-3">
      <!-- BUDGET CARD -->
      <div id="budgetCard" class="card slide-up">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center mb-3">
            <div>
              <h5 style="margin:0;color:var(--warning);">
                <i class="fas fa-wallet"></i> Budget Limit
              </h5>
              <small class="text-muted">Set a monthly/total budget for your expenses</small>
            </div>
            <div>
              <button id="resetBudgetBtn" class="btn btn-outline-danger btn-sm">
                <i class="fas fa-redo"></i> Reset Budget
              </button>
            </div>
          </div>

          <div class="row g-2 mb-3">
            <div class="col-md-5">
              <input type="number" id="budgetInput" class="form-control" placeholder="Enter budget amount (e.g. 5000)" min="1">
            </div>
            <div class="col-md-3">
              <button id="saveBudgetBtn" class="btn btn-primary w-100">
                <i class="fas fa-save"></i> Save Budget
              </button>
            </div>
            <div class="col-md-4 text-end">
              <div id="budgetStatusText" style="font-weight:600;color:var(--text);">
                <i class="fas fa-info-circle"></i> No budget set
              </div>
            </div>
          </div>

          <div class="budget-progress-container">
            <div class="budget-stats">
              <span id="budgetSpent">Spent: ‚Çπ0.00</span>
              <span id="budgetRemaining">Remaining: ‚Çπ0.00</span>
            </div>
            <div id="budgetBar" class="mb-2">
              <div id="budgetProgress" class="progress" style="width:100%">
                <div id="budgetProgressBar" class="progress-bar" role="progressbar" style="width:0%"></div>
              </div>
            </div>
            <div class="budget-labels">
              <span>0%</span>
              <span id="budgetPercentage">0%</span>
              <span>100%</span>
            </div>
          </div>

          <div id="budgetAlerts" style="min-height:22px;"></div>
        </div>
      </div>

      <!-- EXPENSE FORM -->
      <div id="expenseFormContainer" style="display:none;">
        <div class="card slide-up">
          <div class="card-header">
            <h5 class="mb-0"><i class="fas fa-plus-circle"></i> Add New Expense</h5>
          </div>
          <div class="card-body">
            <form id="expenseForm" class="row g-3">
              <input type="hidden" id="editId">
              <div class="col-md-6">
                <label for="name" class="form-label">Name</label>
                <input type="text" id="name" class="form-control" required placeholder="e.g., Grocery Shopping">
              </div>
              <div class="col-md-6">
                <label for="amount" class="form-label">Amount (‚Çπ)</label>
                <input type="number" id="amount" class="form-control" required min="1" step="0.01" placeholder="e.g., 500.50">
              </div>
              <div class="col-md-6">
                <label for="type" class="form-label">Payment Type</label>
                <select id="type" class="form-select" required>
                  <option value="">Choose one...</option>
                  <option value="Card">Card</option>
                  <option value="Cash">Cash</option>
                  <option value="Gpay/Paytm">Gpay/Paytm</option>
                  <option value="Other">Other</option>
                </select>
              </div>
              <div class="col-md-6">
                <label for="description" class="form-label">Description</label>
                <input type="text" id="description" class="form-control" required placeholder="e.g., Weekly grocery purchase">
              </div>
              <div class="col-md-6">
                <label for="date" class="form-label">Date</label>
                <input type="date" id="date" class="form-control" required>
              </div>
              <div class="col-12 d-flex justify-content-between mt-3">
                <button type="reset" class="btn btn-danger">
                  <i class="fas fa-times"></i> Clear
                </button>
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-check"></i> Confirm
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- EXPENSES CONTAINER -->
      <div id="expensesContainer">
        <!-- Will be populated dynamically -->
      </div>

      <!-- ANALYTICS -->
      <div id="analyticsContainer" class="my-4" style="display:none;">
        <div class="card slide-up">
          <div class="card-header">
            <h5 class="mb-0"><i class="fas fa-chart-bar"></i> Expense Analytics</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6">
                <div class="chart-container">
                  <canvas id="lineChart"></canvas>
                </div>
              </div>
              <div class="col-md-6">
                <div class="chart-container">
                  <canvas id="pieChart"></canvas>
                </div>
                <div id="analyticsBadge" class="text-center mt-3"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ABOUT MODAL -->
    <div id="aboutModal" class="modal-overlay">
      <div class="modal-content">
        <h2>About E-TRAX</h2>
        <p><strong>E-TRAX</strong> helps you <strong>track your daily expenses</strong> and manage your budget efficiently.</p>
        <h4><i class="fas fa-lightbulb"></i> Purpose</h4>
        <p>Record, categorize, and analyze your spending patterns easily.</p>
        <h4><i class="fas fa-cogs"></i> How It Works</h4>
        <ul>
          <li>Add expenses with name, amount, and date.</li>
          <li>View and edit them anytime.</li>
          <li>Check total expenses instantly.</li>
          <li>See visual analytics of your spending trends.</li>
          <li>Set budget limits and track your spending against them.</li>
          <li>Track complete edit history with user details.</li>
        </ul>
        <div style="text-align:center;">
          <button id="closeAbout" class="btn btn-primary">Close</button>
        </div>
      </div>
    </div>

    <!-- HISTORY MODAL -->
    <div id="historyModal" class="modal-overlay">
      <div class="modal-content">
        <h2><i class="fas fa-history"></i> Edit History</h2>
        <div id="historyContent">
          <p>Loading history...</p>
        </div>
        <div style="text-align:center; margin-top: 20px;">
          <button id="closeHistory" class="btn btn-primary">Close</button>
        </div>
      </div>
    </div>

    <!-- MESSAGE BOX -->
    <div id="msgBox"></div>

    <script>
    // ==================== ENHANCED LOADING SYSTEM ====================
 
        
    // ==================== ENHANCED DATA LOADING & RENDERING ====================
async function loadData() {
  if (!auth.currentUser) return;
  
  try {
    showLoading("Loading your expenses...");
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/users`, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    if (!res.ok) throw new Error("Failed to fetch users");
    const users = await res.json();
    
    if (!Array.isArray(users) || users.length === 0) {
      clearExpensesUI();
      elements.analyticsContainer.style.display = "none";
      
      // Fetch budget with token
      const bRes = await fetch(`${BASE_URL}/getBudget`, {
        headers: {
          'Authorization': `Bearer ${token}`
        }
      });
      
      if (bRes.ok) {
        const b = await bRes.json();
        if (b && b.amount) {
          updateBudgetUI(parseFloat(b.amount), 0);
        }
      }
      return;
    }

    renderExpenses(users);
    renderCharts(users);
    elements.analyticsContainer.style.display = "block";
    
    // Fetch and update budget with token
    const bRes = await fetch(`${BASE_URL}/getBudget`, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    if (bRes.ok) {
      const b = await bRes.json();
      if (b && b.amount && parseFloat(b.amount) > 0) {
        let totalAmount = 0;
        users.forEach(u => totalAmount += parseFloat(u.amount) || 0);
        updateBudgetUI(parseFloat(b.amount), totalAmount);
      } else {
        clearBudgetUI();
      }
    }
  } catch(err) { 
    console.error(err); 
    showErrorUI();
  } finally {
    hideLoading();
  }
}

// ==================== ENHANCED EXPENSE FORM ====================
elements.form?.addEventListener("submit", async e => {
  e.preventDefault();
  if (!auth.currentUser) return;
  
  const data = {
    name: document.getElementById("name").value.trim(),
    amount: parseFloat(document.getElementById("amount").value).toFixed(2),
    type: document.getElementById("type").value,
    description: document.getElementById("description").value.trim(),
    date: document.getElementById("date").value
  };
  
  // Validate data
  if (!data.name || !data.amount || !data.type || !data.description || !data.date) {
    showMessage("‚ùå Please fill all fields correctly", 2000);
    return;
  }
  
  if (parseFloat(data.amount) <= 0) {
    showMessage("‚ùå Amount must be greater than 0", 2000);
    return;
  }
  
  try {
    showLoading(elements.editId.value ? "Updating expense..." : "Adding expense...");
    
    const url = elements.editId.value ? `${BASE_URL}/update/${elements.editId.value}` : `${BASE_URL}/submit`;
    const method = elements.editId.value ? "PUT" : "POST";
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    if (elements.editId.value) {
      data.editorName = currentUserName;
    }
    
    const res = await fetch(url, { 
      method, 
      headers: { 
        "Content-Type": "application/json",
        'Authorization': `Bearer ${token}`
      }, 
      body: JSON.stringify(data)
    });
    
    const result = await res.json();
    
    if (res.ok) {
      showMessage(elements.editId.value ? "‚úÖ Expense updated successfully" : "‚úÖ Expense added successfully");
      elements.editId.value = "";
      elements.form.reset();
      
      // Reset date to today
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('date').value = today;
      
      await loadData();
    } else {
      showMessage(result.message || "‚ùå Operation failed", 2500);
    }
  } catch(err) { 
    console.error(err); 
    showMessage("‚ùå Network error. Please try again.", 2500);
  } finally {
    hideLoading();
  }
});

// ==================== ENHANCED EDIT & DELETE ====================
window.editExpense = async function(id) {
  try {
    showLoading("Loading expense details...");
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/user/${id}`, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    if (!res.ok) throw new Error("Failed to fetch user");
    const user = await res.json();
    
    document.getElementById("name").value = user.name;
    document.getElementById("amount").value = user.amount;
    document.getElementById("type").value = user.type;
    document.getElementById("description").value = user.description;
    document.getElementById("date").value = user.date;
    elements.editId.value = id;
    
    setupEditCancelButton();
    showMessage("‚úè Edit mode enabled. Make your changes and click Confirm.", 3000);
    
    // Scroll to form
    document.getElementById('expenseFormContainer').scrollIntoView({ 
      behavior: 'smooth' 
    });
  } catch(err) { 
    console.error(err); 
    showMessage("‚ùå Failed to load expense for editing.", 2500);
  } finally {
    hideLoading();
  }
}

window.deleteExpense = async function(id, name) {
  if (!confirm(`Are you sure you want to delete "${name}"?\nThis action cannot be undone.`)) return;
  
  try {
    showLoading("Deleting expense...");
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/delete/${id}`, { 
      method: "DELETE",
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    
    const r = await res.json();
    
    if (res.ok) {
      showMessage("‚úÖ Expense deleted successfully");
      await loadData();
    } else {
      showMessage(r.message || "‚ùå Delete failed", 2000);
    }
  } catch(err) { 
    console.error(err); 
    showMessage("‚ùå Network error. Please try again.", 2000);
  } finally {
    hideLoading();
  }
}

// ==================== ENHANCED BUDGET FUNCTIONS ====================
async function fetchBudget() {
  if (!auth.currentUser) {
    clearBudgetUI();
    return;
  }
  
  try {
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/getBudget`, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    if (!res.ok) {
      clearBudgetUI();
      return;
    }
    
    const r = await res.json();
    if (!r || typeof r.amount === "undefined" || r.amount === 0) {
      currentBudgetAmount = 0;
      clearBudgetUI();
      return;
    }
    
    currentBudgetAmount = parseFloat(r.amount) || 0;
    
    // Load expenses to calculate total
    const expensesRes = await fetch(`${BASE_URL}/users`, {
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    const arr = await expensesRes.json();
    
    let totalAmount = 0;
    if (Array.isArray(arr)) {
      arr.forEach(x => totalAmount += parseFloat(x.amount) || 0);
    }
    
    updateBudgetUI(currentBudgetAmount, totalAmount);
    if (elements.budgetInput) {
      elements.budgetInput.value = currentBudgetAmount;
    }
  } catch(err) { 
    console.error(err); 
    clearBudgetUI();
  }
}

// Budget event listeners
elements.saveBudgetBtn?.addEventListener("click", async () => {
  const val = parseFloat(elements.budgetInput.value);
  if (!val || val <= 0) {
    showMessage("‚ùå Please enter a valid budget amount", 2000);
    return;
  }
  
  try {
    showLoading("Saving budget...");
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/setBudget`, {
      method: "POST",
      headers: { 
        "Content-Type": "application/json",
        'Authorization': `Bearer ${token}`
      },
      body: JSON.stringify({ 
        amount: parseFloat(val) || 0 
      })
    });
    
    const r = await res.json();
    
    if (res.ok) {
      showMessage(r.message || "‚úÖ Budget saved successfully");
      await fetchBudget();
    } else {
      showMessage(r.message || "‚ùå Failed to save budget");
    }
  } catch(err) { 
    console.error(err); 
    showMessage("‚ùå Network error. Please try again.", 2000);
  } finally {
    hideLoading();
  }
});

elements.resetBudgetBtn?.addEventListener("click", async () => {
  if (!auth.currentUser) return;
  
  if (!confirm("Are you sure you want to reset/delete your budget?")) return;
  
  try {
    showLoading("Resetting budget...");
    
    // Get fresh token
    const token = await auth.currentUser.getIdToken();
    
    const res = await fetch(`${BASE_URL}/setBudget`, {
      method: "POST",
      headers: { 
        "Content-Type": "application/json",
        'Authorization': `Bearer ${token}`
      },
      body: JSON.stringify({ 
        reset: true 
      })
    });
    
    const r = await res.json();
    
    if (res.ok) {
      showMessage(r.message || "‚úÖ Budget reset successfully");
      clearBudgetUI();
    } else {
      showMessage(r.message || "‚ùå Reset failed");
    }
  } catch(err) { 
    console.error(err); 
    showMessage("‚ùå Network error. Please try again.", 2000);
  } finally {
    hideLoading();
  }
});
    </script>

    <footer>
      <div class="footer-content">
        <p style="margin:0;">Developed with <i class="fas fa-heart" style="color: var(--danger);"></i> by <strong class="blinking-name">ALPHA DEVELOPERS</strong></p>
        <p style="margin:10px 0 0 0;">
          <a href="mailto:santhoshgowtham777@gmail.com">
            <i class="fas fa-envelope"></i> santhoshgowtham777@gmail.com
          </a>
        </p>
        <p style="margin:10px 0 0 0;">&copy; 2025 E-TRAX. All rights reserved.</p>
      </div>
    </footer>
  </body>
</html>
